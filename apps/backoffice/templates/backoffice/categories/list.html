{% extends "backoffice/base_backoffice.html" %}
{% load breadcrumbs %}

{% block title %}Listado de Categorías{% endblock %}

{% block breadcrumb %}
  {% breadcrumb "Categorías|categories:list" %}
{% endblock %}

{% block content %}
<div class="container-fluid py-4">
  <div class="d-flex justify-content-between align-items-center mb-4">
    <div>
      <h1 class="h4 mb-1">Categorías (Padre / Hija)</h1>
      <p class="text-muted mb-0">Gestiona la estructura jerárquica de categorías</p>
    </div>
    <div class="d-flex gap-2">
      <a href="{% url 'backoffice:categories:create' %}" class="btn btn-primary" role="button">
        <i class="bi bi-plus-lg me-1"></i>Nueva categoría
      </a>
      <a href="{% url 'backoffice:categories:absolute_create' %}" class="btn btn-success" role="button">
        <i class="bi bi-plus-lg me-1"></i>Nuevo deporte
      </a>
    </div>
  </div>

  <div class="card shadow-sm">
    <div class="card-body p-0">
      <div class="table-responsive">
        <table class="table table-hover align-middle mb-0" role="grid">
          <thead class="bg-light">
            <tr>
              <th scope="col">Nombre</th>
              <th scope="col">Padre</th>
              <th scope="col">Estado</th>
              <th scope="col" class="text-end">Acciones</th>
            </tr>
          </thead>
          <tbody>
          {% for c in categorias %}
            <tr>
              <td class="text-nowrap">
                {% for anc in c.get_ancestors %}
                  <span class="text-muted ms-3"></span>
                {% endfor %}
                {{ c.name }}
              </td>
              <td>{% if c.parent %}{{ c.parent.name }}{% else %}<span class="text-muted">-</span>{% endif %}</td>
              <td>
                <span class="badge {% if c.is_active %}bg-success{% else %}bg-secondary{% endif %}">
                  {{ c.is_active|yesno:"Activo,Inactivo" }}
                </span>
              </td>
              <td class="text-end">
                <div class="btn-group" role="group" aria-label="Acciones de categoría">
                  <a href="{% url 'backoffice:categories:detail' c.pk %}"
                     class="btn btn-sm btn-outline-primary"
                     aria-label="Ver detalles de {{ c.name }}">
                    <i class="bi bi-eye"></i>
                  </a>
                  <a href="{% url 'backoffice:categories:edit' c.pk %}"
                     class="btn btn-sm btn-outline-secondary"
                     aria-label="Editar {{ c.name }}">
                    <i class="bi bi-pencil"></i>
                  </a>
                  <a href="{% url 'backoffice:categories:delete' c.pk %}"
                     class="btn btn-sm btn-outline-danger"
                     aria-label="Eliminar {{ c.name }}">
                    <i class="bi bi-trash"></i>
                  </a>
                </div>
              </td>
            </tr>
          {% empty %}
            <tr>
              <td colspan="4" class="text-center py-4">
                <div class="text-muted">
                  <i class="bi bi-emoji-frown fs-4 d-block mb-2"></i>
                  No hay categorías registradas
                </div>
              </td>
            </tr>
          {% endfor %}
          </tbody>
        </table>
    </div>
  </div>
</div>
{% endblock %}
